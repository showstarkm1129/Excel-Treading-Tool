トリガー発注仕様（trigger-logic）

このExcelシートを利用する前に、楽天証券RSSアドインをExcelに導入してから操作してください。
楽天証券公式ページ：
https://marketspeed.jp/ms2_rss/

開始手順

楽天証券のMarketSpeedを開いてからExcelを開く

TOPメニューにある「マーケットスピードⅡ」をクリック

マーケットスピードのアイコンをクリックして接続状態にする

接続状態になったら、その右にある「発注不可」アイコンもクリックして発注可能状態にする

発注開始手順
発注IDセットボタンを押して
O22に発注IDがセットされたことを確認
例：10001

トリガー条件設定
① 狙い（セル S15）
空売りの場合は「2」を選択

② 価格差（セル S16）
条件には使用しないためデフォルト

トレード開始前に設定してほしい箇所
銘柄コード（K16）
K16セルに取引したい銘柄コードを入力
例：1570

売買区分（O27）
買建    1
売建    3

注文数量（O31）
ロット数を入力

トレーリングストップ設定
5分足の高値から何円下がったら利確するかを設定
上ヒゲの値幅がどのくらいになったら利確するかを決定

ストップロス設定
建値から何円下がったら損切りするかを決定
デフォルト：10円

発注条件
T19セルが条件を満たして「1」になると
発注確認画面が表示されます

トリガー発注について
T19が1になると発注されます
注文確認画面が表示されたら
発注する場合はEnterキーを押してください

参照セル一覧
V12  現在値
W12  前回値
X12  現在の5分足の高値
Y12  現在の5分足の安値
Z12  トレーリングストップ幅
AA12 ストップロス幅

トリガー発注① ロジック
T19セルの数式
=IF(
AND(R19=1, AND(V15="OK", V16="OK")),
IF(
S15=1,
IF(V12 > W12, 1, 0),
IF(
S15=2,
IF(V12 < W12, 1, 0)
)
),
"-"
)

判定条件
上昇狙い（S15=1）
現在値 ＞ 前回値 → 1

下降狙い（S15=2）
現在値 ＜ 前回値 → 1

トリガー発注② ロジック
T19セルの数式
=IF(
AND(R20=1, AND(V15="OK", V16="OK")),
IF(
S15=1,
IF(
OR(
V12 < S12,
X12 - V12 >= Z12,
O47 - V12 >= AA12
),
1,
0
),
IF(
S15=2,
IF(
OR(
V12 > S12,
V12 - Y12 >= Z12,
V12 - O47 >= AA12
),
1,
0
),
0
)
),
"-"
)

判定条件まとめ
上昇狙い（S15=1）
現在値 ＜ 移動平均線1
高値 − 現在値 ≥ トレーリング幅
建単価 − 現在値 ≥ ストップロス幅


いずれか成立 → 発注

下降狙い（S15=2）
現在値 ＞ 移動平均線1
現在値 − 安値 ≥ トレーリング幅
現在値 − 建単価 ≥ ストップロス幅


いずれか成立 → 発注