トリガー発注仕様（trigger-logic）
このExcelシートを利用する前に楽天証券のRSSのアドインをExcelに導入してから操作してください。
以下に楽天証券公式のMARKETSPEEDⅡRSSの公式ページ
https://marketspeed.jp/ms2_rss/

開始手順

`
楽天証券のMarketSpeedを開いてからExcelを開き、
TOPメニューにあるマーケットスピードⅡをクリック
マーケットスピードのアイコンをクリックして接続状態にします。
接続状態になったらその右にある発注不可というアイコンもクリックして発注可能状態にしてください。
`

`
発注を開始するには
`

発注IDセットボタンを押してO22に発注IDがセットされたことを確認します。`例：10001`


トリガー条件を決めます。

①の狙いのセルS15
`
空売りの場合は2を選択
`

②価格差のセルS16
条件には使用しないのでデフォルト

ートレード開始前に設定してほしい箇所ー

K16セルに取引したい銘柄のコードを入力してください。

`
例：1570
`


        売買区分O27
        買建    1
        売建    3

```python
注文数量O31
        ロット数を入力してください。

```

トレーリングストップ幅を決めます。
```
ここでは５分足の高値から何円下がったら利確注文を出すか決められます。
上ヒゲの値幅がどのぐらいになったら利確するかを決めます。
```
ストップロス
    ここでは建値から何円下がったら損切りをするのかを決めます。
    デフォルトは10円です。


以上で発注準備完了です。

T19のセルが条件を満たして1になったら発注確認画面が表示されます。


トリガー発注について
    T19が1になると発注されます。

    1になると注文確認画面が表示されるので
    発注する場合はEnterキーを押してください。


参照場所
```    V12(現在値)
    W12(前回値)
    X12(現在の5分足の高値)
    Y12(現在の5分足の安値)
    Z12(トレーリングストップの幅)
    AA12(ストップロス幅)
```

トリガー発注シートの
    T19セルの中身
```    =IF(
    AND(R19=1, AND(V15="OK", V16="OK")),
    IF(
        S15=1,
        IF(V12 > W12, 1, 0),
        IF(
            S15=2,
            IF(V12 < W12, 1, 0)
        )
    ),
    "-"
    )
```
```    トリガー発注監視セルが1の時に
        もしS15が1上昇狙いの時
        現在値が前回値より大きかったら1

        もしS15が2下降狙いの時
        現在値が前回値より小さかったら1
```

トリガー発注(2)の
    T19のセルの中身
```    =IF(
    AND(R20=1, AND(V15="OK", V16="OK")),
    IF(
        S15=1,
        IF(
            OR(
            V12 < S12,
            X12 - V12 >= Z12,
            O47 - V12 >= AA12
            ),
            1,
            0
        ),
        IF(
            S15=2,
            IF(
            OR(
                V12 > S12,
                V12 - Y12 >= Z12,
                V12 - O47 >= AA12
            ),
            1,
            0
            ),
            0
        )
    ),
    "-"
    )
```
    トリガー発注監視セルが1の時に
        もしS15が1上昇狙いの時
            現在値が移動平均線1よりも小さい
            直近の高値-現在値がトレーリングストップ以上なら1
            建単価-現在値がストップロスの設定値以上なら1

    もしS15が2下降狙いの時
            現在値が移動平均線1よりも大きい
            直近の安値-現在値がトレーリングストップ以上なら1
            現在値-建単価がストップロスの設定値以上なら1
